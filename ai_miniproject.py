# -*- coding: utf-8 -*-
"""AI Miniproject.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/181FWX36e-FqCh-skJ5gwYDu2kfwq7CK7

Weather forecasting system
"""

import os
import datetime

import IPython
import IPython.display
import matplotlib as mpl
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
import seaborn as sns
import tensorflow as tf

mpl.rcParams['figure.figsize'] = (8, 6)
mpl.rcParams['axes.grid'] = False

zip_path = tf.keras.utils.get_file(
    origin='https://storage.googleapis.com/tensorflow/tf-keras-datasets/jena_climate_2009_2016.csv.zip',
    fname='jena_climate_2009_2016.csv.zip',
    extract=True)
csv_path, _ = os.path.splitext(zip_path)

df = pd.read_csv(csv_path)
# Slice [start:stop:step], pobiera co 6 wiersz zaczynajÄ…c od indeksu 5.
df = df[5::6]

date_time = pd.to_datetime(df.pop('Date Time'), format='%d.%m.%Y %H:%M:%S')

df.head()

plot_cols = ['T (degC)', 'p (mbar)', 'rho (g/m**3)']
plot_features = df[plot_cols]
plot_features.index = date_time
_ = plot_features.plot(subplots=True)

plot_features = df[plot_cols][:480]
plot_features.index = date_time[:480]
_ = plot_features.plot(subplots=True)

df.describe().transpose()

wv = df['wv (m/s)']
bad_wv = wv == -9999.0
wv[bad_wv] = 0.0

max_wv = df['max. wv (m/s)']
bad_max_wv = max_wv == -9999.0
max_wv[bad_max_wv] = 0.0

df['wv (m/s)'].min()

plt.hist2d(df['wd (deg)'], df['wv (m/s)'], bins=(50, 50), vmax=400)
plt.colorbar()
plt.xlabel('Wind Direction [deg]')
plt.ylabel('Wind Velocity [m/s]')

wv = df.pop('wv (m/s)')
max_wv = df.pop('max. wv (m/s)')

# Zamiana na radiany
wd_rad = df.pop('wd (deg)') * np.pi / 180

# Oblicza x i y dla wiatru
df['Wx'] = wv * np.cos(wd_rad)
df['Wy'] = wv * np.sin(wd_rad)

# Oblicza maks. x i y dla wiatru
df['max Wx'] = max_wv * np.cos(wd_rad)
df['max Wy'] = max_wv * np.sin(wd_rad)

plt.hist2d(df['Wx'], df['Wy'], bins=(50, 50), vmax=400)
plt.colorbar()
plt.xlabel('Wind X [m/s]')
plt.ylabel('Wind Y [m/s]')
ax = plt.gca()
ax.axis('tight')

timestamp_s = date_time.map(datetime.datetime.timestamp)

day = 24 * 60 * 60
year = 365.2425 * day

df['Day sin'] = np.sin(timestamp_s * (2 * np.pi / day))
df['Day cos'] = np.cos(timestamp_s * (2 * np.pi / day))
df['Year sin'] = np.sin(timestamp_s * (2 * np.pi / year))
df['Year cos'] = np.cos(timestamp_s * (2 * np.pi / year))

plt.plot(np.array(df['Day sin'])[:25])
plt.plot(np.array(df['Day cos'])[:25])
plt.xlabel('Time [h]')
plt.title('TIme of day signal')

fft = tf.signal.rfft(df['T (degC)'])
f_per_dataset = np.arange(0, len(fft))

n_samples_h = len(df['T (degC)'])
hours_per_year = 24 * 365.2524
years_per_dataset = n_samples_h / hours_per_year

f_per_year = f_per_dataset / years_per_dataset
plt.step(f_per_year, np.abs(fft))
plt.xscale('log')
plt.ylim(0, 400000)
plt.xlim([0.1, max(plt.xlim())])
plt.xticks([1, 365.2524], labels=['1/Year', '1/Day'])
_ = plt.xlabel('Frequency (log scale)')

column_indices = {name: i for i, name in enumerate(df.columns)}

n = len(df)
train_df = df[0:int(n * 0.7)]
val_df = df[int(n * 0.7):int(n * 0.9)]
test_df = df[int(n * 0.9):]

num_features = df.shape[1]

train_mean = train_df.mean()
train_std = train_df.std()

train_df = (train_df - train_mean) / train_std
val_df = (val_df - train_mean) / train_std
test_df = (test_df - train_mean) / train_std

df_std = (df - train_mean) / train_std
df_std = df_std.melt(var_name='Column', value_name='Normalized')
plt.figure(figsize=(12, 6))
ax = sns.violinplot(x='Column', y='Normalized', data=df_std)
_ = ax.set_xticklabels(df.keys(), rotation=90)

class WindowGenerator():
  def __init__(self, input_width, label_width, shift,
               train_df=train_df, val_df=val_df, test_df=test_df,
               label_columns=None):
    self.train_df = train_df
    self.val_df = val_df
    self.test_df = test_df

    self.label_columns = label_columns
    if label_columns is not None:
      self.label_columns_indices = {name: i for i, name in enumerate(label_columns)}

    self.column_indices = {name: i for i, name in enumerate(train_df.columns)}

    self.input_width = input_width
    self.label_width = label_width
    self.shift = shift

    self.total_window_size = input_width + shift

    self.input_slice = slice(0, input_width)
    self.input_indices = np.arange(self.total_window_size)[self.input_slice]

    self.label_start = self.total_window_size - self.label_width
    self.labels_slice = slice(self.label_start, None)
    self.label_indices = np.arange(self.total_window_size)[self.labels_slice]

  def __repr__(self):
    return '\n'.join([
      f'Total window size: {self.total_window_size}',
      f'Input indices: {self.input_indices}',
      f'Label indices: {self.label_indices}',
      f'Label column name(s): {self.label_columns}'])

w1 = WindowGenerator(input_width=24, label_width=1, shift=24,
                     label_columns=['T (degC)'])
w1

"""![raw_window_24h.png](data:image/png;base64,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)"""

w2 = WindowGenerator(input_width=6, label_width=1, shift=1,
                     label_columns=['T (degC)'])
w2

"""![raw_window_1h.png](data:image/png;base64,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)"""

def split_window(self, features):
  inputs = features[:, self.input_slice, :]
  labels = features[:, self.labels_slice, :]
  if self.label_columns is not None:
    labels = tf.stack(
        [labels[:, :, self.column_indices[name]] for name in self.label_columns],
        axis=-1)
    
  inputs.set_shape([None, self.input_width, None])
  labels.set_shape([None, self.label_width, None])

  return inputs, labels

WindowGenerator.split_window = split_window

example_window = tf.stack([np.array(train_df[:w2.total_window_size]),
                           np.array(train_df[100:100 + w2.total_window_size]),
                           np.array(train_df[200:200 + w2.total_window_size])])

example_inputs, example_labels = w2.split_window(example_window)

print('All shapes are: (batch, time, features)')
print(f'Window shape: {example_window.shape}')
print(f'Inputs shape: {example_inputs.shape}')
print(f'labels shape: {example_labels.shape}')

"""![split_window.png](data:image/png;base64,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)"""

w2.example = example_inputs, example_labels

def plot(self, model=None, plot_col='T (degC)', max_subplots=3):
  inputs, labels = self.example
  plt.figure(figsize=(12, 8))
  plot_col_index = self.column_indices[plot_col]
  max_n = min(max_subplots, len(inputs))

  for n in range(max_n):
    plt.subplot(3, 1, n + 1)
    plt.ylabel(f'{plot_col} [normed]')
    plt.plot(self.input_indices, inputs[n, :, plot_col_index], 
             label='Inputs', marker='.', zorder=-10)
    
    if self.label_columns:
      label_col_index = self.label_columns_indices.get(plot_col, None)
    else:
      label_col_index = plot_col_index

    if label_col_index is None:
      continue

    plt.scatter(self.label_indices, labels[n, :, label_col_index],
                edgecolors='k', label='Labels', c='#2ca02c', s=64)
    if model is not None:
      predictions = model(inputs)
      plt.scatter(self.label_indices, predictions[n, :, label_col_index],
                  marker='X', edgecolor='k', label='Predictions', c='#ff7f0e', s=64)
      
    if n == 0:
      plt.legend()

  plt.xlabel('Time [h]')

WindowGenerator.plot = plot

w2.plot()

w2.plot(plot_col='p (mbar)')

def make_dataset(self, data):
  data = np.array(data, dtype=np.float32)
  ds = tf.keras.preprocessing.timeseries_dataset_from_array(
      data=data,
      targets=None,
      sequence_length=self.total_window_size,
      sequence_stride=1,
      shuffle=True,
      batch_size=32,)
  ds = ds.map(self.split_window)

  return ds

WindowGenerator.make_dataset = make_dataset

@property
def train(self):
  return self.make_dataset(self.train_df)

@property
def val(self):
  return self.make_dataset(self.val_df)

@property
def test(self):
  return self.make_dataset(self.test_df)

@property
def example(self):
  result = getattr(self, '_example', None)
  if result is None:
    result = next(iter(self.train))
    self._example = result
  return result

WindowGenerator.train = train
WindowGenerator.val = val
WindowGenerator.test = test
WindowGenerator.example = example

w2.train.element_spec

for example_inputs, example_labels in w2.train.take(1):
  print(f'Inputs shape (batch, time, features): {example_inputs.shape}')
  print(f'Labels shape (batch, time, features): {example_labels.shape}')

single_step_window = WindowGenerator(
    input_width=1, label_width=1, shift=1, label_columns=['T (degC)'])

single_step_window

for example_inputs, example_labels in single_step_window.train.take(1):
  print(f'Inputs shape (batch, time, features): {example_inputs.shape}')
  print(f'Labels shape (batch, time, features): {example_labels.shape}')

class Baseline(tf.keras.Model):
  def __init__(self, label_index=None):
    super().__init__()
    self.label_index = label_index

  def call(self, inputs):
    if self.label_index is None:
      return inputs
    result = inputs[:, :, self.label_index]
    return result[:, :, tf.newaxis]

baseline = Baseline(label_index=column_indices['T (degC)'])

baseline.compile(loss=tf.losses.MeanSquaredError(),
                 metrics=[tf.metrics.MeanAbsoluteError()])

val_performance = {}
performance = {}
val_performance['Baseline'] = baseline.evaluate(single_step_window.val)
performance['Baseline'] = baseline.evaluate(single_step_window.test, verbose=0)

wide_window = WindowGenerator(
    input_width=24, label_width=24, shift=1,
    label_columns=['T (degC)'])

wide_window

print('Input shape:', single_step_window.example[0].shape)
print('Output shape:', baseline(single_step_window.example[0]).shape)

wide_window.plot(baseline)

"""Linear model

"""

linear = tf.keras.Sequential([
    tf.keras.layers.Dense(units=1)
])

print('Input shape:', single_step_window.example[0].shape)
print('Output shape:', linear(single_step_window.example[0]).shape)

MAX_EPOCHS = 20

def compile_and_fit(model, window, patience=2):
  early_stopping = tf.keras.callbacks.EarlyStopping(monitor='val_loss',
                                                    patience=patience,
                                                    mode='min')
  model.compile(loss=tf.losses.MeanSquaredError(),
                optimizer=tf.optimizers.Adam(),
                metrics=[tf.metrics.MeanAbsoluteError()])
  
  history = model.fit(window.train, epochs=MAX_EPOCHS,
                      validation_data=window.val,
                      callbacks=[early_stopping])
  return history

history = compile_and_fit(linear, single_step_window)

val_performance['Linear'] = linear.evaluate(single_step_window.val)
performance['Linear'] = linear.evaluate(single_step_window.test, verbose=0)

print('Input shape:', wide_window.example[0].shape)
print('Output shape:', baseline(wide_window.example[0]).shape)

wide_window.plot(linear)

plt.bar(x = range(len(train_df.columns)),
        height=linear.layers[0].kernel[:, 0].numpy())
axis = plt.gca()
axis.set_xticks(range(len(train_df.columns)))
_ = axis.set_xticklabels(train_df.columns, rotation=90)

"""Recursive neural network"""

lstm_model = tf.keras.models.Sequential([
    # Shape [batch, time, features] => [batch, time, lstm_units]                                     
    tf.keras.layers.LSTM(32, return_sequences=True),
    # Shape => [batch, time, features]
    tf.keras.layers.Dense(1)                                                                
])

print('Input shape:', wide_window.example[0].shape)
print('Output shape:', lstm_model(wide_window.example[0]).shape)

history = compile_and_fit(lstm_model, wide_window)

IPython.display.clear_output()
val_performance['LSTM'] = lstm_model.evaluate(wide_window.val)
performance['LSTM'] = lstm_model.evaluate(wide_window.test, verbose=0)

wide_window.plot(lstm_model)